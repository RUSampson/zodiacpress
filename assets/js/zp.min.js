var zpButton=document.getElementById('zp-fetch-birthreport');zpButton.setAttribute('disabled',!0),function(a){function b(){const c=a('#zp-ajax-birth-data :input').serialize()+'&action=zp_tz_offset',d=new XMLHttpRequest;d.open('POST',zp_ajax_object.ajaxurl),d.setRequestHeader('Content-Type','application/x-www-form-urlencoded'),d.responseType='json',d.onload=function(){var e=document.getElementById('zp-fetch-birthreport');if(200===d.status&&d.response)if(d.response.error){zpRemoveError();var f=document.createElement('span');f.setAttribute('class','ui-state-error'),f.textContent=d.response.error,document.getElementById('zp-ajax-birth-data').appendChild(f)}else d.response.offset_geo&&'false'!=d.response.offset_geo&&(zpRemoveError(),document.getElementById('zp-offset-wrap').style.display='block',document.getElementById('zp-offset-label').textContent=zp_ajax_object.utc+' ',document.getElementById('zp_offset_geo').value=d.response.offset_geo,document.getElementById('zp-form-tip').style.display='block',e.removeAttribute('disabled'))},d.send(c)}a('#place').autocomplete({source:function(c,d){zpRemoveError(),a.ajax({url:zp_ajax_object.autocomplete_ajaxurl,dataType:zp_ajax_object.dataType,type:zp_ajax_object.type,data:{featureClass:'P',style:'full',maxRows:12,username:zp_ajax_object.geonames_user,action:zp_ajax_object.autocomplete_action?zp_ajax_object.autocomplete_action:void 0,name_startsWith:c.term,lang:zp_ajax_object.lang},success:function(e){if(e.status!==void 0){var f=a('<span />');f.attr('class','ui-state-error'),f.text('ERROR '+e.status.value+' - '+e.status.message),a('#zp-ajax-birth-data').append(f)}d(a.map(e.geonames,function(g){return{value:g.name+(g.adminName1?', '+g.adminName1:'')+', '+g.countryName,label:g.name+(g.adminName1?', '+g.adminName1:'')+', '+g.countryName,lngdeci:g.lng,latdeci:g.lat,timezoneid:g.timezone.timeZoneId}}))}})},minLength:2,select:function(c,d){zpRemoveError();var e={geo_timezone_id:d.item.timezoneid,zp_lat_decimal:d.item.latdeci,zp_long_decimal:d.item.lngdeci};for(var f in e){var g=document.getElementById(f);null!==g&&g.remove(),elInput=document.createElement('input'),elInput.setAttribute('type','hidden'),elInput.id=f,elInput.setAttribute('name',f),elInput.setAttribute('value',e[f]),document.getElementById('zp-timezone-id').appendChild(elInput)}b()}}),a('#zp-fetch-birthreport').click(function(){return a.ajax({url:zp_ajax_object.ajaxurl,type:'POST',data:a('#zp-birthreport-form').serialize(),dataType:'json',success:function(c){if(c.error){zpRemoveError();var d=a('<span />');d.attr('class','ui-state-error'),d.text(c.error),a('#zp-offset-wrap').after(d)}else if(a.trim(c.report)&&'false'!=a.trim(c.report)){switch(zpRemoveError(),a('#zp-report-wrap').show(),a('#zp-report-content').append(c.report),a('#zp-form-wrap').hide(),zp_ajax_object.draw){case'top':a('.zp-report-header').length?a('.zp-report-header').after(c.image):a('#zp-report-content').prepend(c.image);break;case'bottom':a('#zp-report-content').append(c.image);}var e=a('#zp-report-wrap').offset().top-70;a('html,body').animate({scrollTop:e},'slow')}}}),!1}),a('#month, #day, #year, #hour, #minute').on('change',function(){var c=!this.options[this.selectedIndex].defaultSelected;c&&zpFieldsFilled()&&b()})}(jQuery);function zpFieldsFilled(){var a=['geo_timezone_id','zp_long_decimal','zp_lat_decimal','place','minute','hour','year','day','month'];for(var b of a){var c=document.getElementById(b);if(null===c)return!1;if(0===c.value.length||!c.value.trim())return!1}return!0}function zpRemoveError(){var a=document.querySelector('.ui-state-error');null!==a&&a.parentNode.removeChild(a)}