var zpSubmit=document.getElementById('zp-fetch-birthreport');zpSubmit.setAttribute('disabled',!0);function zpGetOffset(){const a=jQuery('#zp-ajax-birth-data :input').serialize()+'&action=zp_tz_offset',b=new XMLHttpRequest;b.open('POST',zp_ajax_object.ajaxurl),b.setRequestHeader('Content-Type','application/x-www-form-urlencoded'),b.responseType='json',b.onload=function(){if(200===b.status&&b.response)if(b.response.error){zpRemoveError();var c=document.createElement('span');c.setAttribute('class','ui-state-error'),c.textContent=b.response.error,document.getElementById('zp-ajax-birth-data').appendChild(c)}else b.response.offset_geo&&'false'!=b.response.offset_geo&&(zpRemoveError(),document.getElementById('zp-offset-wrap').style.display='block',document.getElementById('zp-offset-label').textContent=zp_ajax_object.utc+' ',document.getElementById('zp_offset_geo').value=b.response.offset_geo,document.getElementById('zp-form-tip').style.display='block',zpSubmit.removeAttribute('disabled'))},b.send(a)}(function(a){a('#zp-fetch-birthreport').click(function(){return a.ajax({url:zp_ajax_object.ajaxurl,type:'POST',data:a('#zp-birthreport-form').serialize(),dataType:'json',success:function(b){if(b.error){zpRemoveError();var c=a('<span />');c.attr('class','ui-state-error'),c.text(b.error),a('#zp-offset-wrap').after(c)}else{var d=b.report.trim();if(d&&'false'!=d){switch(zpRemoveError(),a('#zp-report-wrap').show(),a('#zp-report-content').append(b.report),a('#zp-form-wrap').hide(),zp_ajax_object.draw){case'top':a('.zp-report-header').length?a('.zp-report-header').after(b.image):a('#zp-report-content').prepend(b.image);break;case'bottom':a('#zp-report-content').append(b.image);}var e=a('#zp-report-wrap').offset().top-70;a('html,body').animate({scrollTop:e},'slow')}}}}),!1}),a('#month, #day, #year, #hour, #minute').on('change',function(){var b=!this.options[this.selectedIndex].defaultSelected;b&&zpFieldsFilled()&&zpGetOffset()})})(jQuery);function zpFieldsFilled(){var a=['geo_timezone_id','zp_long_decimal','zp_lat_decimal','place','minute','hour','year','day','month'];for(var b of a){var c=document.getElementById(b);if(null===c)return!1;if(0===c.value.length||!c.value.trim())return!1}return!0}function zpRemoveError(){var a=document.querySelector('.ui-state-error');null!==a&&a.parentNode.removeChild(a)}
