!function(e){e("#zp-fetch-offset").prop("disabled",!0),e("#place").autocomplete({source:function(t,a){e(".ui-state-error").hide(),e.ajax({url:zp_ajax_object.autocomplete_ajaxurl,dataType:zp_ajax_object.dataType,type:zp_ajax_object.type,data:{featureClass:"P",style:"full",maxRows:12,username:zp_ajax_object.geonames_user,action:zp_ajax_object.autocomplete_action?zp_ajax_object.autocomplete_action:void 0,name_startsWith:t.term,lang:zp_ajax_object.lang},success:function(t){if(e("#zp-fetch-offset").prop("disabled",!0),e("#zp-fetch-birthreport").prop("disabled",!0),void 0!==t.status){var r=e("<span />");r.attr("class","ui-state-error"),r.text("ERROR "+t.status.value+" - "+t.status.message),e("#zp-ajax-birth-data").append(r)}a(e.map(t.geonames,function(e){return{value:e.name+(e.adminName1?", "+e.adminName1:"")+", "+e.countryName,label:e.name+(e.adminName1?", "+e.adminName1:"")+", "+e.countryName,lngdeci:e.lng,latdeci:e.lat,timezoneid:e.timezone.timeZoneId}}))}})},minLength:2,select:function(t,a){e(".ui-state-error").hide(),e("#zp-ajax-loader").css({visibility:"visible"});var r={geo_timezone_id:a.item.timezoneid,zp_lat_decimal:a.item.latdeci,zp_long_decimal:a.item.lngdeci};for(var o in r){var p=document.getElementById(o);null!==p&&p.remove(),elInput=document.createElement("input"),elInput.setAttribute("type","hidden"),elInput.id=o,elInput.setAttribute("name",o),elInput.setAttribute("value",r[o]),document.getElementById("zp-timezone-id").appendChild(elInput)}e("#zp-offset-wrap").hide(),e("#zp-fetch-birthreport").hide(),e("#zp-form-tip").hide(),e("#zp-fetch-offset").show(),e("#zp-ajax-loader").css({visibility:"hidden"}),e("#zp-fetch-offset").prop("disabled",!1)}}),e("#zp-fetch-offset").click(function(t){var a={action:"zp_tz_offset",post_data:e("#zp-ajax-birth-data :input").serialize()};return e.ajax({url:zp_ajax_object.ajaxurl,type:"POST",data:a,dataType:"json",success:function(t){if(t.error){e(".ui-state-error").hide();var a=e("<span />");a.attr("class","ui-state-error"),a.text(t.error),e("#zp-ajax-birth-data").append(a)}else e.trim(t.offset_geo)&&"false"!=e.trim(t.offset_geo)&&(e(".ui-state-error").hide(),e("#zp-offset-wrap").show(),e("#zp-offset-label").text(zp_ajax_object.utc+" "),e("#zp_offset_geo").val(t.offset_geo),e("#zp-form-tip").show(),e("#zp-fetch-offset").hide(),e("#zp-fetch-birthreport").show(),e("#zp-fetch-birthreport").prop("disabled",!1),e("#zp-fetch-birthreport").css({"background-color":"#339933","border-color":"#339933"}))}}),!1}),e("#zp-fetch-birthreport").click(function(){return e.ajax({url:zp_ajax_object.ajaxurl,type:"POST",data:e("#zp-birthreport-form").serialize(),dataType:"json",success:function(t){if(t.error){e(".ui-state-error").hide();var a=e("<span />");a.attr("class","ui-state-error"),a.text(t.error),e("#zp-offset-wrap").after(a)}else if(e.trim(t.report)&&"false"!=e.trim(t.report)){switch(e(".ui-state-error").hide(),e("#zp-report-wrap").show(),e("#zp-report-content").append(t.report),e("#zp-form-wrap").hide(),zp_ajax_object.draw){case"top":e(".zp-report-header").length?e(".zp-report-header").after(t.image):e("#zp-report-content").prepend(t.image);break;case"bottom":e("#zp-report-content").append(t.image)}var r=e("#zp-report-wrap").offset().top-70;e("html,body").animate({scrollTop:r},"slow")}}}),!1}),e("#month, #day, #year, #hour, #minute").on("change",function(){!this.options[this.selectedIndex].defaultSelected&&(e("#zp-offset-wrap").hide(),e("#zp-fetch-birthreport").hide(),e("#zp-form-tip").hide(),e("#zp-fetch-offset").show())})}(jQuery);